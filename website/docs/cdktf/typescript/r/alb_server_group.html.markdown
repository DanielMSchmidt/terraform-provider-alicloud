---
subcategory: "Application Load Balancer (ALB)"
layout: "alicloud"
page_title: "Alicloud: alicloud_alb_server_group"
sidebar_current: "docs-alicloud-resource-alb-server-group"
description: |- 
    Provides a Alicloud ALB Server Group resource.
---


<!-- Please do not edit this file, it is generated. -->
# alicloud\_alb\_server\_group

Provides a ALB Server Group resource.

For information about ALB Server Group and how to use it,
see [What is Server Group](https://www.alibabacloud.com/help/doc-detail/213627.htm).

-> **NOTE:** Available in v1.131.0+.

## Example Usage

Basic Usage

```typescript
import * as constructs from "constructs";
import * as cdktf from "cdktf";
/*Provider bindings are generated by running cdktf get.
See https://cdk.tf/provider-generation for more details.*/
import * as alicloud from "./.gen/providers/alicloud";
class MyConvertedCode extends cdktf.TerraformStack {
  constructor(scope: constructs.Construct, name: string) {
    super(scope, name);
    /*Terraform Variables are not always the best fit for getting inputs in the context of Terraform CDK.
    You can read more about this at https://cdk.tf/variables*/
    const name = new cdktf.TerraformVariable(this, "name", {
      default: "example_value",
    });
    const alicloudVpcDefault = new alicloud.vpc.Vpc(this, "default", {
      cidrBlock: "172.16.0.0/16",
      vpcName: name.stringValue,
    });
    const dataAlicloudImagesDefault =
      new alicloud.dataAlicloudImages.DataAlicloudImages(this, "default_2", {
        mostRecent: true,
        nameRegex: "^ubuntu_18.*64",
        owners: "system",
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAlicloudImagesDefault.overrideLogicalId("default");
    const dataAlicloudResourceManagerResourceGroupsDefault =
      new alicloud.dataAlicloudResourceManagerResourceGroups.DataAlicloudResourceManagerResourceGroups(
        this,
        "default_3",
        {}
      );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAlicloudResourceManagerResourceGroupsDefault.overrideLogicalId(
      "default"
    );
    const dataAlicloudZonesDefault =
      new alicloud.dataAlicloudZones.DataAlicloudZones(this, "default_4", {
        availableDiskCategory: "cloud_efficiency",
        availableResourceCreation: "VSwitch",
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAlicloudZonesDefault.overrideLogicalId("default");
    const alicloudSecurityGroupDefault =
      new alicloud.securityGroup.SecurityGroup(this, "default_5", {
        name: name.stringValue,
        vpcId: cdktf.Token.asString(alicloudVpcDefault.id),
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudSecurityGroupDefault.overrideLogicalId("default");
    const alicloudVswitchDefault = new alicloud.vswitch.Vswitch(
      this,
      "default_6",
      {
        cidrBlock: "172.16.0.0/16",
        vpcId: cdktf.Token.asString(alicloudVpcDefault.id),
        vswitchName: name.stringValue,
        zoneId: cdktf.Token.asString(
          cdktf.propertyAccess(dataAlicloudZonesDefault.zones, ["0", "id"])
        ),
      }
    );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudVswitchDefault.overrideLogicalId("default");
    const dataAlicloudInstanceTypesDefault =
      new alicloud.dataAlicloudInstanceTypes.DataAlicloudInstanceTypes(
        this,
        "default_7",
        {
          availabilityZone: cdktf.Token.asString(
            cdktf.propertyAccess(dataAlicloudZonesDefault.zones, ["0", "id"])
          ),
          cpuCoreCount: 1,
          memorySize: 2,
        }
      );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAlicloudInstanceTypesDefault.overrideLogicalId("default");
    const alicloudInstanceDefault = new alicloud.instance.Instance(
      this,
      "default_8",
      {
        availabilityZone: cdktf.Token.asString(
          cdktf.propertyAccess(dataAlicloudZonesDefault.zones, ["0", "id"])
        ),
        imageId: cdktf.Token.asString(
          cdktf.propertyAccess(dataAlicloudImagesDefault.images, ["0", "id"])
        ),
        instanceChargeType: "PostPaid",
        instanceName: name.stringValue,
        instanceType: cdktf.Token.asString(
          cdktf.propertyAccess(dataAlicloudInstanceTypesDefault.instanceTypes, [
            "0",
            "id",
          ])
        ),
        internetChargeType: "PayByTraffic",
        internetMaxBandwidthOut: cdktf.Token.asNumber("10"),
        securityGroups: cdktf.Token.asList(
          cdktf.propertyAccess(alicloudSecurityGroupDefault, ["*", "id"])
        ),
        systemDiskCategory: "cloud_efficiency",
        vswitchId: cdktf.Token.asString(alicloudVswitchDefault.id),
      }
    );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudInstanceDefault.overrideLogicalId("default");
    const alicloudAlbServerGroupDefault =
      new alicloud.albServerGroup.AlbServerGroup(this, "default_9", {
        healthCheckConfig: {
          healthCheckCodes: ["http_2xx", "http_3xx", "http_4xx"],
          healthCheckConnectPort: cdktf.Token.asNumber("46325"),
          healthCheckEnabled: true,
          healthCheckHost: "tf-testAcc.com",
          healthCheckHttpVersion: "HTTP1.1",
          healthCheckInterval: cdktf.Token.asNumber("2"),
          healthCheckMethod: "HEAD",
          healthCheckPath: "/tf-testAcc",
          healthCheckProtocol: "HTTP",
          healthCheckTimeout: 5,
          healthyThreshold: 3,
          unhealthyThreshold: 3,
        },
        protocol: "HTTP",
        resourceGroupId: cdktf.Token.asString(
          cdktf.propertyAccess(
            dataAlicloudResourceManagerResourceGroupsDefault.groups,
            ["0", "id"]
          )
        ),
        serverGroupName: name.stringValue,
        servers: [
          {
            description: name.stringValue,
            port: 80,
            serverId: cdktf.Token.asString(alicloudInstanceDefault.id),
            serverIp: cdktf.Token.asString(alicloudInstanceDefault.privateIp),
            serverType: "Ecs",
            weight: 10,
          },
        ],
        stickySessionConfig: {
          cookie: "tf-testAcc",
          stickySessionEnabled: true,
          stickySessionType: "Server",
        },
        tags: {
          Created: "TF",
        },
        vpcId: cdktf.Token.asString(alicloudVpcDefault.id),
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudAlbServerGroupDefault.overrideLogicalId("default");
  }
}

```

## Argument Reference

The following arguments are supported:

* `dryRun` - (Optional) The dry run.
* `healthCheckConfig` - (Optional) The configuration of health checks.
* `protocol` - (Optional, Computed, ForceNew) The server protocol. Valid values: ` HTTPS`, `http`.
* `resourceGroupId` - (Optional) The ID of the resource group.
* `scheduler` - (Optional, Computed) The scheduling algorithm. Valid values: ` Sch`, ` Wlc`, `wrr`.
* `serverGroupName` - (Optional) The name of the resource.
* `servers` - (Optional) The backend server.
* `stickySessionConfig` - (Optional, ForceNew) The configuration of the sticky session.
* `vpcId` - (Optional, ForceNew) The ID of the VPC that you want to access.
* `serverGroupType` - (Optional, ForceNew, Computed, Available in v1.193.0+) The type of the server group. Valid values:
  - `instance` (default): allows you add servers by specifying Ecs, Ens, or Eci.
  - `ip`: allows you to add servers by specifying IP addresses.
  - `fc`: allows you to add servers by specifying functions of Function Compute.
* `tags` - (Optional) A mapping of tags to assign to the resource.

#### Block sticky_session_config

The sticky_session_config supports the following:

* `cookie` - the cookie that is configured on the server. **NOTE:** This parameter exists if the `stickySession`
  parameter is set to `on` and the `stickySessionType` parameter is set to `server`.
* `cookieTimeout` - The timeout period of a cookie. The timeout period of a cookie. Unit: seconds. Valid values: `1`
  to `86400`. Default value: `1000`.
* `stickySessionEnabled` - Indicates whether sticky session is enabled. Values: `true` and `false`. Default
  value: `false`.  **NOTE:** This parameter exists if the `stickySession` parameter is set to `on`.
* `stickySessionType` - The method that is used to handle a cookie. Values: `server` and `insert`.

#### Block servers

The servers supports the following:

* `serverType` - (Required) The type of the server. The type of the server. Valid values: 
  - Ecs: an ECS instance.
  - Eni: an ENI.
  - Eci: an elastic container instance.
  - Ip(Available in v1.194.0+): an IP address.
  - fc(Available in v1.194.0+): a function.
* `weight` - (Optional, Computed) The weight of the server. Valid values: `0` to `100`. Default value: `100`. If the value is set to `0`, no
  requests are forwarded to the server. **Note:** You do not need to set this parameter if you set `serverType` to `fc`.
* `description` - (Optional) The description of the server.
* `port` - (Optional) The port that is used by the server. Valid values: `1` to `65535`. **Note:** This parameter is required if the `serverType` parameter is set to `ecs`, `eni`, `eci`, or `ip`. You do not need to configure this parameter if you set `serverType` to `fc`.
* `serverId` -  (Required) The ID of the backend server.
  - If `serverGroupType` is set to `instance`, set the parameter to the ID of an Elastic Compute Service (ECS) instance, an elastic network interface (ENI), or an elastic container instance. These backend servers are specified by Ecs, Eni, or Eci.
  - If `serverGroupType` is set to `ip`, set the parameter to an IP address specified in the server group.
  - If `serverGroupType` is set to `fc`, set the parameter to the Alibaba Cloud Resource Name (ARN) of a function specified in the server group.
* `serverIp` - (Optional, Computed) The IP address of an Elastic Compute Service (ECS) instance, an elastic network interface (ENI), or an elastic container instance. **Note:** If `serverGroupType` is set to `fc`, you do not need to configure parameters, otherwise this attribute is required. If `serverGroupType` is set to `ip`, the value of this property is the same as the `serverId` value.
* `remoteIpEnabled` - (Optional, Computed, Available in v1.194.0+) Specifies whether to enable the remote IP address feature. You can specify up to 40 servers in each call. **Note:** If `serverType` is set to `ip`, this parameter is available.

#### Block health_check_config

The health_check_config supports the following:

* `unhealthyThreshold` - The number of consecutive health checks that a healthy backend server must consecutively fail
  before it is declared unhealthy. In this case, the health check state is changed from success to fail. Valid
  values: `2` to `10`. Default value: `3`.
* `healthCheckCodes` - The status code for a successful health check. Multiple status codes can be specified as a
  list. Valid values: `http2Xx`, `http3Xx`, `http4Xx`, and `http5Xx`. Default value: `http2Xx`. **NOTE:** This
  parameter exists if the `healthCheckProtocol` parameter is set to `http`.
* `healthCheckPath` - The forwarding rule path of health checks. **NOTE:** This parameter exists if
  the `healthCheckProtocol` parameter is set to `http`.
* `healthyThreshold` - The number of health checks that an unhealthy backend server must pass consecutively before it
  is declared healthy. In this case, the health check state is changed from fail to success. Valid values: 2 to 10.
  Default value: 3.
* `healthCheckHttpVersion` - HTTP protocol version. Valid values: `http10` and `http11`. Default value: `http11`
  . **NOTE:** This parameter exists if the `healthCheckProtocol` parameter is set to `http`.
* `healthCheckInterval` - The time interval between two consecutive health checks. Unit: seconds. Valid values: `1`
  to `50`. Default value: `2`.
* `healthCheckMethod` - Health check method. Valid values: `get` and `head`. Default: `get`. **NOTE:** This parameter
  exists if the `healthCheckProtocol` parameter is set to `http`.
* `healthCheckProtocol` - Health check protocol. Valid values: `http` and `tcp`.
* `healthCheckTimeout` - The timeout period of a health check response. If a backend Elastic Compute Service (ECS)
  instance does not send an expected response within the specified period of time, the ECS instance is considered
  unhealthy. Unit: seconds. Valid values: 1 to 300. Default value: 5. **NOTE:** If the value of the `healthCHeckTimeout`
  parameter is smaller than that of the `healthCheckInterval` parameter, the value of the `healthCHeckTimeout` parameter
  is ignored and the value of the `healthCheckInterval` parameter is regarded as the timeout period.
* `healthCheckConnectPort` - The port of the backend server that is used for health checks. Valid values: `0`
  to `65535`. Default value: `0`. A value of 0 indicates that a backend server port is used for health checks.
* `healthCheckEnabled` - Indicates whether health checks are enabled. Valid values: `true`, `false`. Default
  value: `true`.
* `healthCheckHost` - The domain name that is used for health checks.

## Attributes Reference

The following attributes are exported:

* `id` - The resource ID in terraform of Server Group.
* `status` - The status of the resource.

### Timeouts

The `timeouts` block allows you to
specify [timeouts](https://www.terraform.io/docs/configuration-0-11/resources.html#timeouts) for certain actions:

* `create` - (Defaults to 6 mins) Used when create the Instance.
* `update` - (Defaults to 6 mins) Used when update the Instance.
* `delete` - (Defaults to 6 mins) Used when delete the Instance.

## Import

ALB Server Group can be imported using the id, e.g.

```shell
$ terraform import alicloud_alb_server_group.example <id>
```

<!-- cache-key: cdktf-0.17.0-pre.15 input-ea08725afa44f89a7f9705073043d5ebeba3b2150dce9226fc61630fdd9e64da -->