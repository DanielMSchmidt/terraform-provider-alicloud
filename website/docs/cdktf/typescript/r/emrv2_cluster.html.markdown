---
subcategory: "E-MapReduce (EMR)"
layout: "alicloud"
page_title: "Alicloud: alicloud_emrv2_cluster"
sidebar_current: "docs-alicloud-resource-emr-cluster-new"
description: |-
  Provides a EMR Cluster resource.
---


<!-- Please do not edit this file, it is generated. -->
# alicloud_emrv2_cluster

Provides a EMR cluster resource. This resource is based on EMR's new version OpenAPI.

For information about EMR New and how to use it, see [Add a domain](https://www.alibabacloud.com/help/doc-detail/28068.htm).

-> **NOTE:** Available in v1.199.0+.

## Example Usage

Basic Usage

```typescript
import * as constructs from "constructs";
import * as cdktf from "cdktf";
/*Provider bindings are generated by running cdktf get.
See https://cdk.tf/provider-generation for more details.*/
import * as alicloud from "./.gen/providers/alicloud";
class MyConvertedCode extends cdktf.TerraformStack {
  constructor(scope: constructs.Construct, name: string) {
    super(scope, name);
    const alicloudEcsKeyPairDefault = new alicloud.ecsKeyPair.EcsKeyPair(
      this,
      "default",
      {
        keyPairName: "terraform-kp",
      }
    );
    const alicloudRamRoleDefault = new alicloud.ramRole.RamRole(
      this,
      "default_1",
      {
        description: "this is a role test.",
        document:
          '    {\n        "Statement": [\n        {\n            "Action": "sts:AssumeRole",\n            "Effect": "Allow",\n            "Principal": {\n            "Service": [\n                "emr.aliyuncs.com",\n                "ecs.aliyuncs.com"\n            ]\n            }\n        }\n        ],\n        "Version": "1"\n    }\n',
        force: true,
        name: "tftest",
      }
    );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudRamRoleDefault.overrideLogicalId("default");
    const alicloudVpcDefault = new alicloud.vpc.Vpc(this, "default_2", {
      cidrBlock: "172.16.0.0/12",
      vpcName: "TF-VPC",
    });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudVpcDefault.overrideLogicalId("default");
    const dataAlicloudResourceManagerResourceGroupsDefault =
      new alicloud.dataAlicloudResourceManagerResourceGroups.DataAlicloudResourceManagerResourceGroups(
        this,
        "default_3",
        {
          status: "OK",
        }
      );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAlicloudResourceManagerResourceGroupsDefault.overrideLogicalId(
      "default"
    );
    const dataAlicloudZonesDefault =
      new alicloud.dataAlicloudZones.DataAlicloudZones(this, "default_4", {
        availableInstanceType: "ecs.g7.xlarge",
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAlicloudZonesDefault.overrideLogicalId("default");
    const alicloudSecurityGroupDefault =
      new alicloud.securityGroup.SecurityGroup(this, "default_5", {
        name: "TF_SECURITY_GROUP",
        vpcId: cdktf.Token.asString(alicloudVpcDefault.id),
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudSecurityGroupDefault.overrideLogicalId("default");
    const alicloudVswitchDefault = new alicloud.vswitch.Vswitch(
      this,
      "default_6",
      {
        cidrBlock: "172.16.0.0/21",
        vpcId: cdktf.Token.asString(alicloudVpcDefault.id),
        vswitchName: "TF_VSwitch",
        zoneId: cdktf.Token.asString(
          cdktf.propertyAccess(dataAlicloudZonesDefault.zones, ["0", "id"])
        ),
      }
    );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudVswitchDefault.overrideLogicalId("default");
    const alicloudEmrv2ClusterDefault = new alicloud.emrv2Cluster.Emrv2Cluster(
      this,
      "default_7",
      {
        applicationConfigs: [
          {
            applicationName: "HIVE",
            configFileName: "hivemetastore-site.xml",
            configItemKey: "hive.metastore.type",
            configItemValue: "DLF",
            configScope: "CLUSTER",
          },
          {
            applicationName: "SPARK3",
            configFileName: "hive-site.xml",
            configItemKey: "hive.metastore.type",
            configItemValue: "DLF",
            configScope: "CLUSTER",
          },
        ],
        applications: [
          "HADOOP-COMMON",
          "HDFS",
          "YARN",
          "HIVE",
          "SPARK3",
          "TEZ",
        ],
        clusterName: "terraform-emr-cluster-v2",
        clusterType: "DATALAKE",
        deployMode: "NORMAL",
        nodeAttributes: [
          {
            keyPairName: cdktf.Token.asString(alicloudEcsKeyPairDefault.id),
            ramRole: cdktf.Token.asString(alicloudRamRoleDefault.name),
            securityGroupId: cdktf.Token.asString(
              alicloudSecurityGroupDefault.id
            ),
            vpcId: cdktf.Token.asString(alicloudVpcDefault.id),
            zoneId: cdktf.Token.asString(
              cdktf.propertyAccess(dataAlicloudZonesDefault.zones, ["0", "id"])
            ),
          },
        ],
        nodeGroups: [
          {
            dataDisks: [
              {
                category: "cloud_essd",
                count: 3,
                size: 80,
              },
            ],
            instanceTypes: ["ecs.g7.xlarge"],
            nodeCount: 1,
            nodeGroupName: "emr-master",
            nodeGroupType: "MASTER",
            paymentType: "PayAsYouGo",
            systemDisk: {
              category: "cloud_essd",
              count: 1,
              size: 80,
            },
            vswitchIds: [cdktf.Token.asString(alicloudVswitchDefault.id)],
            withPublicIp: false,
          },
          {
            dataDisks: [
              {
                category: "cloud_essd",
                count: 3,
                size: 80,
              },
            ],
            instanceTypes: ["ecs.g7.xlarge"],
            nodeCount: 3,
            nodeGroupName: "emr-core",
            nodeGroupType: "CORE",
            paymentType: "PayAsYouGo",
            systemDisk: {
              category: "cloud_essd",
              count: 1,
              size: 80,
            },
            vswitchIds: [cdktf.Token.asString(alicloudVswitchDefault.id)],
            withPublicIp: false,
          },
        ],
        paymentType: "PayAsYouGo",
        releaseVersion: "EMR-5.10.0",
        resourceGroupId: cdktf.Token.asString(
          cdktf.propertyAccess(
            dataAlicloudResourceManagerResourceGroupsDefault.ids,
            ["0"]
          )
        ),
        securityMode: "NORMAL",
        tags: {
          created: "tf",
        },
      }
    );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudEmrv2ClusterDefault.overrideLogicalId("default");
  }
}

```
## Argument Reference

The following arguments are supported:

* `resourceGroupId` - (Optional, Computed) The Id of resource group which the emr-cluster belongs.
* `paymentType` - (Optional, Computed, ForceNew) Payment Type for this cluster. Supported value: PayAsYouGo or Subscription.
* `subscriptionConfig` - (Optional) The detail configuration of subscription payment type.
* `clusterType` - (Required, ForceNew) EMR Cluster Type, e.g. DATALAKE, OLAP, DATAFLOW, DATASERVING, CUSTOM etc. You can find all valid EMR cluster type in emr web console.
* `releaseVersion` - (Required, ForceNew) EMR Version, e.g. EMR-5.10.0. You can find the all valid EMR Version in emr web console.
* `clusterName` - (Required) The name of emr cluster. The name length must be less than 64. Supported characters: chinese character, english character, number, "-", "_".
* `deployMode` - (Optional, Computed, ForceNew) The deploy mode of EMR cluster. Supported value: NORMAL or HA.
* `securityMode` - (Optional, Computed) The security mode of EMR cluster. Supported value: NORMAL or KERBEROS.
* `applications` - (Required, ForceNew) The applications of EMR cluster to be installed, e.g. HADOOP-COMMON, HDFS, YARN, HIVE, SPARK2, SPARK3, ZOOKEEPER etc. You can find all valid applications in emr web console.
* `applicationConfigs` - (Optional) The application configurations of EMR cluster.
* `nodeAttributes` - (Required) The node attributes of ecs instances which the emr-cluster belongs.
* `nodeGroups` - (Required) Groups of node, You can specify MASTER as a group, CORE as a group (just like the above example).
* `bootstrapScripts` (Optional) The bootstrap scripts to be effected when creating emr-cluster or resize emr-cluster.
* `tags` - (Optional) A mapping of tags to assign to the resource.

### Block subscription_config

The `subscriptionConfig` block supports the following:

* `paymentDurationUnit` - (Required) If paymentType is Subscription, this should be specified. Supported value: Month or Year.
* `paymentDuration` - (Required) If paymentType is Subscription, this should be specified. Supported value: 1、2、3、4、5、6、7、8、9、12、24、36、48.
* `autoRenew` - (Optional) Auto renew for prepaid, ’true’ or ‘false’ . Default value: false.
* `autoRenewDurationUnit` - (Optional) If paymentType is Subscription, this should be specified. Supported value: Month or Year.
* `autoRenewDuration` - (Optional) If paymentType is Subscription, this should be specified. Supported value: 1、2、3、4、5、6、7、8、9、12、24、36、48. 

### Block application_configs

The `applicationConfigs` block supports the following:

* `applicationName` - (Required) The application name of EMR cluster which has installed.
* `configFileName` - (Required) The configuration file name of application installed.
* `configItemKey` - (Required) The configuration item key of application installed.
* `configItemValue` - (Required) The configuration item value of application installed.
* `configScope` - (Optional) The configuration scope of emr cluster. Supported value: CLUSTER or NODEGROUP.
* `configDescription` - (Optional) The configuration description of application installed.
* `nodeGroupName` - (Optional) The configuration effected which node group name of emr cluster.
* `nodeGroupId` - (Optional) The configuration effected which node group id of emr cluster.

### Block node_attributes

The `nodeAttributes` block supports the following:

* `vpcId` - (Required) Used to retrieve instances belong to specified VPC.
* `zoneId` - (Required) Zone ID, e.g. cn-hangzhou-i
* `securityGroupId` - (Required) Security Group ID for Cluster.
* `ramRole` - (Required) Alicloud EMR uses roles to perform actions on your behalf when provisioning cluster resources, running applications, dynamically scaling resources. EMR uses the following roles when interacting with other Alicloud services. Default value is AliyunEmrEcsDefaultRole.
* `keyPairName` - (Required) The name of the key pair.
* `dataDiskEncrypted` - (Optional, Computed, Available in 1.204.0+) Whether to enable data disk encryption.
* `dataDiskKmsKeyId` - (Optional, Computed, Available in 1.204.0+) The kms key id used to encrypt the data disk. It takes effect when data_disk_encrypted is true.

#### Block node_groups

The node_groups mapping supports the following: 

* `nodeGroupType` - (Required) The node group type of emr cluster, supported value: MASTER, CORE or TASK.
* `nodeGroupName` - (Required) The node group name of emr cluster.
* `paymentType` - (Required) Payment Type for this cluster. Supported value: PayAsYouGo or Subscription.
* `subscriptionConfig` - (Optional) The detail configuration of subscription payment type.
* `spotBidPrices` - (Optional) The spot bid prices of a PayAsYouGo instance.
* `vswitchIds` - (Optional) Global vSwitch ids, you can also specify it in node group.
* `withPublicIp` - (Optional) Whether the node has a public IP address enabled.
* `additionalSecurityGroupIds` - (Optional) Additional security Group IDS for Cluster, you can also specify this key for each node group.
* `instanceTypes` - (Required) Host Ecs instance types.
* `nodeCount` - (Required) Host Ecs number in this node group.
* `systemDisk` - (Required) Host Ecs system disk information in this node group.
* `dataDisks` - (Required) Host Ecs data disks information in this node group.
* `gracefulShutdown` - (Optional) Enable emr cluster of task node graceful decommission, ’true’ or ‘false’ .
* `spotInstanceRemedy` - (Optional) Whether to replace spot instances with newly created spot/onDemand instance when receive a spot recycling message.
* `costOptimizedConfig` - (Optional) The detail cost optimized configuration of emr cluster.

#### Block spot_bid_prices

The spot_bid_prices mapping supports the following: 

* `instanceType` - (Required) Host Ecs instance type.
* `bidPrice` - (Required) The spot bid price of a PayAsYouGo instance.

#### Block system_disk

The system_disk mapping supports the following: 

* `category` - (Required) The type of the data disk. Valid values: `cloudEfficiency` and `cloudEssd`.
* `size` - (Required)The size of a data disk, at least 40. Unit: GiB.
* `performanceLevel` - (Optional) Worker node data disk performance level, when `category` values `cloudEssd`, the optional values are `pl0`, `pl1`, `pl2` or `pl3`, but the specific performance level is related to the disk capacity.
* `count` - (Optional) The count of a data disk.

#### Block data_disks

The data_disks mapping supports the following: 

* `category` - (Required) The type of the data disk. Valid values: `cloudEfficiency` and `cloudEssd`.
* `size` - (Required)The size of a data disk, at least 40. Unit: GiB.
* `performanceLevel` - (Optional) Worker node data disk performance level, when `category` values `cloudEssd`, the optional values are `pl0`, `pl1`, `pl2` or `pl3`, but the specific performance level is related to the disk capacity.
* `count` - (Optional) The count of a data disk.

#### Block cost_optimized_config

The cost_optimized_config mapping supports the following: 

* `onDemandBaseCapacity` - (Required) The cost optimized configuration which on demand based capacity.
* `onDemandPercentageAboveBaseCapacity` - (Required) The cost optimized configuration which on demand percentage above based capacity.
* `spotInstancePools` - (Required) The cost optimized configuration with spot instance pools.

#### Block bootstrap_scripts

The bootstrap_scripts mapping supports the following: 

* `scriptName` - (Required) The bootstrap script name.
* `scriptPath` - (Required) The bootstrap script path, e.g. "oss://bucket/path".
* `scriptArgs` - (Required) The bootstrap script args, e.g. "--a=b".
* `priority` - (Optional) The bootstrap scripts priority.
* `executionMoment` - (Required) The bootstrap scripts execution moment, ’BEFORE_INSTALL’ or ‘AFTER_STARTED’ .
* `executionFailStrategy` - (Required) The bootstrap scripts execution fail strategy, ’FAILED_BLOCKED’ or ‘FAILED_CONTINUE’ .
* `nodeSelector` - (Required) The bootstrap scripts execution target.

#### Block node_selector

The node_selector mapping supports the following: 

* `nodeSelectType` - (Required) The bootstrap scripts execution target node select type. Supported value: NODE, NODEGROUP or CLUSTER.
* `nodeNames` - (Optional) The bootstrap scripts execution target node names.
* `nodeGroupId` - (Optional) The bootstrap scripts execution target node group id.
* `nodeGroupTypes` - (Optional) The bootstrap scripts execution target node group types.
* `nodeGroupName` - (Optional) The bootstrap scripts execution target node group name.

## Attributes Reference

The following attributes are exported:

* `id` - The emr cluster ID.

#### Timeouts

The `timeouts` block allows you to specify [timeouts](https://www.terraform.io/docs/configuration-0-11/resources.html#timeouts) for certain actions:

* `create` - (Defaults to 10 mins) Used when creating the cluster (until it reaches the initial `running` status). 
* `delete` - (Defaults to 5 mins) Used when terminating the cluster.

## Import

Aliclioud E-MapReduce cluster can be imported using the id e.g.

```shell
$ terraform import alicloud_emrv2_cluster.default <id>
```
<!-- cache-key: cdktf-0.17.0-pre.15 input-49d8b8409a44d28d04c4b06dbd8e43195e13485c0aec15639e9d028a5abfcf35 -->