---
subcategory: "VPC"
layout: "alicloud"
page_title: "Alicloud: alicloud_vpc_traffic_mirror_session"
sidebar_current: "docs-alicloud-resource-vpc-traffic-mirror-session"
description: |-
  Provides a Alicloud VPC Traffic Mirror Session resource.
---


<!-- Please do not edit this file, it is generated. -->
# alicloud_vpc_traffic_mirror_session

Provides a VPC Traffic Mirror Session resource. Traffic mirroring session.

For information about VPC Traffic Mirror Session and how to use it, see [What is Traffic Mirror Session](https://www.alibabacloud.com/help/en/doc-detail/261364.htm).

-> **NOTE:** Available in v1.142.0+.

## Example Usage

Basic Usage

```typescript
import * as constructs from "constructs";
import * as cdktf from "cdktf";
/*Provider bindings are generated by running cdktf get.
See https://cdk.tf/provider-generation for more details.*/
import * as alicloud from "./.gen/providers/alicloud";
class MyConvertedCode extends cdktf.TerraformStack {
  constructor(scope: constructs.Construct, name: string) {
    super(scope, name);
    const alicloudVpcTrafficMirrorFilterDefault =
      new alicloud.vpcTrafficMirrorFilter.VpcTrafficMirrorFilter(
        this,
        "default",
        {
          trafficMirrorFilterDescription: "example_value",
          trafficMirrorFilterName: "example_value",
        }
      );
    const dataAlicloudImagesDefault =
      new alicloud.dataAlicloudImages.DataAlicloudImages(this, "default_1", {
        mostRecent: true,
        nameRegex: "^ubuntu_[0-9]+_[0-9]+_x64*",
        owners: "system",
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAlicloudImagesDefault.overrideLogicalId("default");
    const dataAlicloudInstanceTypesDefault =
      new alicloud.dataAlicloudInstanceTypes.DataAlicloudInstanceTypes(
        this,
        "default_2",
        {
          instanceTypeFamily: "ecs.g7",
        }
      );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAlicloudInstanceTypesDefault.overrideLogicalId("default");
    const dataAlicloudVpcsDefault =
      new alicloud.dataAlicloudVpcs.DataAlicloudVpcs(this, "default_3", {
        nameRegex: "default-NODELETING",
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAlicloudVpcsDefault.overrideLogicalId("default");
    const dataAlicloudZonesDefault =
      new alicloud.dataAlicloudZones.DataAlicloudZones(this, "default_4", {
        availableInstanceType: cdktf.Token.asString(
          cdktf.propertyAccess(dataAlicloudInstanceTypesDefault.instanceTypes, [
            "0",
            "id",
          ])
        ),
        availableResourceCreation: "Instance",
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAlicloudZonesDefault.overrideLogicalId("default");
    const alicloudSecurityGroupDefault =
      new alicloud.securityGroup.SecurityGroup(this, "default_5", {
        description: "New security group",
        name: "tf-test",
        vpcId: cdktf.Token.asString(
          cdktf.propertyAccess(dataAlicloudVpcsDefault.ids, ["0"])
        ),
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudSecurityGroupDefault.overrideLogicalId("default");
    const dataAlicloudVswitchesDefault =
      new alicloud.dataAlicloudVswitches.DataAlicloudVswitches(
        this,
        "default_6",
        {
          vpcId: cdktf.Token.asString(
            cdktf.propertyAccess(dataAlicloudVpcsDefault.ids, ["0"])
          ),
          zoneId: cdktf.Token.asString(
            cdktf.propertyAccess(dataAlicloudZonesDefault.zones, ["0", "id"])
          ),
        }
      );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    dataAlicloudVswitchesDefault.overrideLogicalId("default");
    const vswitchId = cdktf.propertyAccess(dataAlicloudVswitchesDefault.ids, [
      "0",
    ]);
    /*In most cases loops should be handled in the programming language context and 
    not inside of the Terraform context. If you are looping over something external, e.g. a variable or a file input
    you should consider using a for loop. If you are looping over something only known to Terraform, e.g. a result of a data source
    you need to keep this like it is.*/
    const alicloudEcsNetworkInterfaceDefaultCount = cdktf.TerraformCount.of(
      cdktf.Token.asNumber("2")
    );
    const alicloudEcsNetworkInterfaceDefault =
      new alicloud.ecsNetworkInterface.EcsNetworkInterface(this, "default_7", {
        networkInterfaceName: "example_value",
        securityGroupIds: [
          cdktf.Token.asString(alicloudSecurityGroupDefault.id),
        ],
        vswitchId: vswitchId,
        count: alicloudEcsNetworkInterfaceDefaultCount,
      });
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudEcsNetworkInterfaceDefault.overrideLogicalId("default");
    /*In most cases loops should be handled in the programming language context and 
    not inside of the Terraform context. If you are looping over something external, e.g. a variable or a file input
    you should consider using a for loop. If you are looping over something only known to Terraform, e.g. a result of a data source
    you need to keep this like it is.*/
    const alicloudInstanceDefaultCount = cdktf.TerraformCount.of(
      cdktf.Token.asNumber("2")
    );
    const alicloudInstanceDefault = new alicloud.instance.Instance(
      this,
      "default_8",
      {
        availabilityZone: cdktf.Token.asString(
          cdktf.propertyAccess(dataAlicloudZonesDefault.zones, ["0", "id"])
        ),
        hostName: "tf-testAcc",
        imageId: cdktf.Token.asString(
          cdktf.propertyAccess(dataAlicloudImagesDefault.images, ["0", "id"])
        ),
        instanceName: "example_value",
        instanceType: cdktf.Token.asString(
          cdktf.propertyAccess(dataAlicloudInstanceTypesDefault.instanceTypes, [
            "0",
            "id",
          ])
        ),
        securityGroups: [cdktf.Token.asString(alicloudSecurityGroupDefault.id)],
        systemDiskCategory: "cloud_essd",
        vswitchId: vswitchId,
        count: alicloudInstanceDefaultCount,
      }
    );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudInstanceDefault.overrideLogicalId("default");
    /*In most cases loops should be handled in the programming language context and 
    not inside of the Terraform context. If you are looping over something external, e.g. a variable or a file input
    you should consider using a for loop. If you are looping over something only known to Terraform, e.g. a result of a data source
    you need to keep this like it is.*/
    const alicloudEcsNetworkInterfaceAttachmentDefaultCount =
      cdktf.TerraformCount.of(cdktf.Token.asNumber("2"));
    const alicloudEcsNetworkInterfaceAttachmentDefault =
      new alicloud.ecsNetworkInterfaceAttachment.EcsNetworkInterfaceAttachment(
        this,
        "default_9",
        {
          instanceId: cdktf.Token.asString(
            cdktf.Fn.element(
              cdktf.propertyAccess(alicloudInstanceDefault, ["*", "id"]),
              cdktf.Token.asNumber(
                alicloudEcsNetworkInterfaceAttachmentDefaultCount.index
              )
            )
          ),
          networkInterfaceId: cdktf.Token.asString(
            cdktf.Fn.element(
              cdktf.propertyAccess(alicloudEcsNetworkInterfaceDefault, [
                "*",
                "id",
              ]),
              cdktf.Token.asNumber(
                alicloudEcsNetworkInterfaceAttachmentDefaultCount.index
              )
            )
          ),
          count: alicloudEcsNetworkInterfaceAttachmentDefaultCount,
        }
      );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudEcsNetworkInterfaceAttachmentDefault.overrideLogicalId("default");
    const alicloudVpcTrafficMirrorSessionDefault =
      new alicloud.vpcTrafficMirrorSession.VpcTrafficMirrorSession(
        this,
        "default_10",
        {
          priority: 1,
          trafficMirrorFilterId: cdktf.Token.asString(
            alicloudVpcTrafficMirrorFilterDefault.id
          ),
          trafficMirrorSessionDescription: "example_value",
          trafficMirrorSessionName: "example_value",
          trafficMirrorSourceIds: [
            cdktf.Token.asString(
              cdktf.propertyAccess(
                alicloudEcsNetworkInterfaceAttachmentDefault,
                ["1", "network_interface_id"]
              )
            ),
          ],
          trafficMirrorTargetId: cdktf.Token.asString(
            cdktf.propertyAccess(alicloudEcsNetworkInterfaceAttachmentDefault, [
              "0",
              "network_interface_id",
            ])
          ),
          trafficMirrorTargetType: "NetworkInterface",
          virtualNetworkId: 10,
        }
      );
    /*This allows the Terraform resource name to match the original name. You can remove the call if you don't need them to match.*/
    alicloudVpcTrafficMirrorSessionDefault.overrideLogicalId("default");
  }
}

```


## Argument Reference

The following arguments are supported:
* `dryRun` - (Optional) Whether to PreCheck only this request, value:
  - **true**: sends a check request and does not create a mirror session. Check items include whether required parameters are filled in, request format, and restrictions. If the check fails, the corresponding error is returned. If the check passes, the error code 'DryRunOperation' is returned '.
  - **false** (default): Sends a normal request and directly creates a mirror session after checking.
* `enabled` - (Optional) Specifies whether to enable traffic mirror sessions. default to `false`.
* `packetLength` - (Optional, ForceNew, Computed, Available in v1.206.0+) Maximum Transmission Unit (MTU).
* `priority` - (Required) The priority of the traffic mirror session. Valid values: `1` to `32766`. A smaller value indicates a higher priority. You cannot specify the same priority for traffic mirror sessions that are created in the same region with the same Alibaba Cloud account.
* `resourceGroupId` - (Optional, Computed, Available in v1.206.0+) The ID of the resource group.
* `tags` - (Optional, Map, Available in v1.206.0+) The tags of this resource.
* `trafficMirrorFilterId` - (Required) The ID of the filter.
* `trafficMirrorSessionDescription` - (Optional) The description of the traffic mirror session. The description must be `2` to `256` characters in length and cannot start with `http://` or `https://`.
* `trafficMirrorSessionName` - (Optional)  The name of the traffic mirror session. The name must be `2` to `128` characters in length and can contain digits, underscores (_), and hyphens (-). It must start with a letter.
* `trafficMirrorSourceIds` - (Required) The ID of the image source instance. Currently, the Eni is supported as the image source. The default value of N is 1, that is, only one mirror source can be added to a mirror session.
* `trafficMirrorTargetId` - (Required) The ID of the mirror destination. You can specify only an ENI or a Server Load Balancer (SLB) instance as a mirror destination.
* `trafficMirrorTargetType` - (Required) The type of the mirror destination. Valid values: `networkInterface` or `slb`. `networkInterface`: an ENI. `slb`: an internal-facing SLB instance.
* `virtualNetworkId` - (Optional, Computed) The VXLAN network identifier (VNI) that is used to distinguish different mirrored traffic. Valid values: `0` to `16777215`. You can specify VNIs for the traffic mirror destination to identify mirrored traffic from different sessions. If you do not specify a VNI, the system randomly allocates a VNI. If you want the system to randomly allocate a VNI, ignore this parameter.



## Attributes Reference

The following attributes are exported:
* `id` - The ID of the resource supplied above.
* `status` - The status of the resource.

### Timeouts

The `timeouts` block allows you to specify [timeouts](https://www.terraform.io/docs/configuration-0-11/resources.html#timeouts) for certain actions:
* `create` - (Defaults to 5 mins) Used when create the Traffic Mirror Session.
* `delete` - (Defaults to 5 mins) Used when delete the Traffic Mirror Session.
* `update` - (Defaults to 5 mins) Used when update the Traffic Mirror Session.

## Import

VPC Traffic Mirror Session can be imported using the id, e.g.

```shell
$ terraform import alicloud_vpc_traffic_mirror_session.example <id>
```
<!-- cache-key: cdktf-0.17.0-pre.15 input-6d72765c6ec4ad85aba1757d525dfd1b05fec6a14633780e3f37a5e773bdca11 -->